
build_pivot_control
Build a blocks_to_rowrecs()/rowrecs_to_blocks() control table that
specifies a pivot from a data.frame.

#### Description 


Some discussion and examples   can be found here: https://winvector.github.io/FluidData/
FluidData.html.

#### Usage 
 <pre><code>
build_pivot_control(table, columnToTakeKeysFrom, columnToTakeValuesFrom,
..., prefix = columnToTakeKeysFrom, sep = NULL)
## Default S3 method:
build_pivot_control(table, columnToTakeKeysFrom,
columnToTakeValuesFrom, ..., prefix = columnToTakeKeysFrom,
sep = NULL)
## S3 method for class 'relop'build_pivot_control
7
build_pivot_control(table, columnToTakeKeysFrom,
columnToTakeValuesFrom, ..., prefix = columnToTakeKeysFrom,
sep = NULL, tmp_name_source = wrapr::mk_tmp_name_source("bpc"),
temporary = FALSE)
</code></pre>
#### Arguments 

table
data.frame to scan for new column names (in-memory data.frame).
columnToTakeKeysFrom
character name of column build new column names from.
columnToTakeValuesFrom
character name of column to get values from.
... not used, force later args to be by name
prefix column name prefix (only used when sep is not NULL)
sep
separator to build complex column names.
tmp_name_source
a tempNameGenerator from cdata::mk_tmp_name_source()
temporary
logical, if TRUE use temporary tables
Value
control table
See Also
blocks_to_rowrecs, build_pivot_control_q


#### Examples 
```{r}
d <- data.frame(measType = c("wt", "ht"),
measValue = c(150, 6),
stringsAsFactors = FALSE)
build_pivot_control(d,
'measType', 'measValue',
sep = '_')
```

```{r}
d <- data.frame(measType = c("wt", "ht"),
measValue = c(150, 6),
stringsAsFactors = FALSE)
ops <- rquery::local_td(d) %.>%
build_pivot_control(.,
'measType', 'measValue',
sep = '_')
cat(format(ops))
if(requireNamespace("rqdatatable", quietly = TRUE)) {8
build_pivot_control_q
}
```

```{r}
library("rqdatatable")
d %.>%
ops %.>%
print(.)
if(requireNamespace("RSQLite", quietly = TRUE)) {
db <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
DBI::dbWriteTable(db,
'd',
d,
overwrite = TRUE,
temporary = TRUE)
db %.>%
ops %.>%
print(.)
DBI::dbDisconnect(db)
}
build_pivot_control_q Build a blocks_to_rowrecs_q() control table that specifies a pivot
(query based, takes name of table).

#### Description 


Some discussion and examples   can be found here: https://winvector.github.io/FluidData/
FluidData.html.

#### Usage 
 <pre><code>
build_pivot_control_q(tableName, columnToTakeKeysFrom,
columnToTakeValuesFrom, my_db, ..., prefix = columnToTakeKeysFrom,
sep = NULL)
</code></pre>
#### Arguments 

tableName
Name of table to scan for new column names.
columnToTakeKeysFrom
character name of column build new column names from.
columnToTakeValuesFrom
character name of column to get values from.
my_db db handle
... not used, force later args to be by name
prefix column name prefix (only used when sep is not NULL)
sep separator to build complex column names.build_unpivot_control
9
Value
control table
See Also
blocks_to_rowrecs_q, build_pivot_control_q


#### Examples 
```{r}
if (requireNamespace("DBI", quietly = TRUE) &&
requireNamespace("RSQLite", quietly = TRUE)) {
my_db <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
d <- data.frame(measType = c("wt", "ht"),
measValue = c(150, 6),
stringsAsFactors = FALSE)
DBI::dbWriteTable(my_db,
'd',
d,
overwrite = TRUE,
temporary = TRUE)
build_pivot_control_q('d', 'measType', 'measValue',
my_db = my_db,
sep = '_') %.>%
print(.)
DBI::dbDisconnect(my_db)
}
build_unpivot_control Build a rowrecs_to_blocks() control table that specifies a un-pivot (or
"shred").

#### Description 


Some discussion and examples   can be found here: https://winvector.github.io/FluidData/
FluidData.html and here https://github.com/WinVector/cdata.

#### Usage 
 <pre><code>
build_unpivot_control(nameForNewKeyColumn, nameForNewValueColumn,
columnsToTakeFrom, ...)
</code></pre>
#### Arguments 

nameForNewKeyColumn
character name of column to write new keys in.
nameForNewValueColumn
character name of column to write new values in.10
checkColsFormUniqueKeys
columnsToTakeFrom
character array names of columns to take values from.
...
not used, force later args to be by name
Value
control table
See Also
rowrecs_to_blocks_q, rowrecs_to_blocks


#### Examples 
```{r}
build_unpivot_control("measurmentType", "measurmentValue", c("c1", "c2"))
cdata
cdata: Fluid Data Transformations.

#### Description 

Supplies implementations of higher order "fluid data" transforms. These’ transforms move data be-
tween rows and columns, are controlled by a graphical transformation specification, and have pivot
and un-pivot as special cases. Large scale implementation is based on ’DBI’, so should be usable
on ’DBI’ compliant data sources (include large systems such as ’PostgreSQL’ and ’Spark’). Conve-
nience adapters are provided for in-memory ’data.frame’s. A theory of fluid data transforms can be
found in the following articles: http://winvector.github.io/FluidData/FluidDataReshapingWithCdata.
html, https://github.com/WinVector/cdata and https://winvector.github.io/FluidData/
FluidData.html.
checkColsFormUniqueKeys
Check that a set of columns form unique keys.

#### Description 

For local data.frame only.

#### Usage 
 <pre><code>
checkColsFormUniqueKeys(data, keyColNames)map_fields
11
</code></pre>
#### Arguments 

data data.frame to work with.
keyColNames character array of column names to check.
Value
logical TRUE if the rows of data are unique addressable by the columns named in keyColNames.


#### Examples 
```{r}
d <- data.frame(key = c('a','a', 'b'), k2 = c(1 ,2, 2))
checkColsFormUniqueKeys(d, 'key') # should be FALSE
checkColsFormUniqueKeys(d, c('key', 'k2')) # should be TRUE
map_fields
Map field values from one column into new derived columns (takes a
data.frame).

#### Description 

Map field values from one column into new derived columns (takes a data.frame).

#### Usage 
 <pre><code>
map_fields(d, cname, m)
</code></pre>
#### Arguments 

d name of table to re-map.
cname name of column to re-map.
m name of table of data describing the mapping (cname column is source, derived
columns are destinations).
Value
re-mapped table12
map_fields_q


#### Examples 
```{r}
d <- data.frame(what = c("acc", "loss",
"val_acc", "val_loss"),
score = c(0.8, 1.2,
0.7, 1.7),
stringsAsFactors = FALSE)
m <- data.frame(what = c("acc", "loss",
"val_acc", "val_loss"),
measure = c("accuracy", "log-loss",
"accuracy", "log-loss"),
dataset = c("train", "train", "validation", "validation"),
stringsAsFactors = FALSE)
map_fields(d, 'what', m)
```
